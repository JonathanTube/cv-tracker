generator client {
  provider = "prisma-client"
  output   = "./prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Country {
  id        String    @id @default(auto()) @map("_id") @db.ObjectId
  name      String    @unique
  companies Company[]
}

model Industry {
  id        String    @id @default(auto()) @map("_id") @db.ObjectId
  name      String    @unique
  companies Company[]
}

model Company {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId
  name       String
  website    String
  Country    Country?  @relation(fields: [countryId], references: [id])
  countryId  String?   @db.ObjectId
  Industry   Industry? @relation(fields: [industryId], references: [id])
  industryId String?   @db.ObjectId
}

model TechStack {
  id    String  @id @default(auto()) @map("_id") @db.ObjectId
  name  String
  Job   Job?    @relation(fields: [jobId], references: [id])
  jobId String? @db.ObjectId
}

model Job {
  id            String        @id @default(auto()) @map("_id") @db.ObjectId
  title         String
  sourceUrl     String
  onlineTestUrl String
  homeworkQuize String
  applications  Application[]
  techStacks    TechStack[]
}

model User {
  id           String        @id @default(auto()) @map("_id") @db.ObjectId
  username     String
  nickname     String
  applications Application[]
}

enum ApplicationState {
  POSTED
  REJECTED
  ONGOING
  FAILED
}

model Application {
  id          String           @id @default(auto()) @map("_id") @db.ObjectId
  coverLetter String
  state       ApplicationState @default(POSTED)
  Job         Job?             @relation(fields: [jobId], references: [id])
  jobId       String?          @db.ObjectId
  User        User?            @relation(fields: [userId], references: [id])
  userId      String?          @db.ObjectId
}
